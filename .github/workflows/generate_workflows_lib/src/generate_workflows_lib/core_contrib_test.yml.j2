# Do not edit this file.
# This file is generated automatically by executing tox -e generate-workflows

name: Core Contrib Test {{ file_number }}

on:
  workflow_call:
    inputs:
      CORE_REPO_SHA:
        required: true
        type: string
      CONTRIB_REPO_SHA:
        required: true
        type: string

permissions:
  contents: read

env:
  CORE_REPO_SHA: ${% raw %}{{ inputs.CORE_REPO_SHA }}{% endraw %}
  CONTRIB_REPO_SHA: ${% raw %}{{ inputs.CONTRIB_REPO_SHA }}{% endraw %}
  PIP_EXISTS_ACTION: w

jobs:
  {%- for job_data in job_datas %}

  {{ job_data.tox_env }}:
    name: {{ job_data.ui_name }}
    runs-on: ubuntu-latest
    timeout-minutes: 30
    steps:
      - name: Checkout contrib repo @ SHA - ${% raw %}{{ env.CONTRIB_REPO_SHA }}{% endraw %}
        uses: actions/checkout@v4
        with:
          repository: open-telemetry/opentelemetry-python-contrib
          ref: ${% raw %}{{ env.CONTRIB_REPO_SHA }}{% endraw %}

      - name: Checkout core repo @ SHA - ${% raw %}{{ env.CORE_REPO_SHA }}{% endraw %}
        uses: actions/checkout@v4
        with:
          repository: open-telemetry/opentelemetry-python
          ref: ${% raw %}{{ env.CORE_REPO_SHA }}{% endraw %}
          path: opentelemetry-python

      - name: Set up Python 3.9
        uses: actions/setup-python@v5
        with:
          python-version: "3.9"
          architecture: "x64"

      - name: Install tox
        run: pip install tox-uv

      - name: Run tests
        run: tox -e {{ job_data.tox_env }} -- -ra
  {%- endfor %}
